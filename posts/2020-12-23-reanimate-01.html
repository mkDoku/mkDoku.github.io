<!doctype html>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title> Reanimate 01 - Installation, Lines and Animation </title>

    <link rel="stylesheet" href="../css/default.css" />
    <link rel="stylesheet" href="../css/syntax.css" />
    <link rel="icon" href="../images/aboutMe/me16x16.png" type="image/x-icon" />
  </head>

  <body>
    <header>

      <div class="nav">
        <div class="legal"> © 2021 Sascha Bubeck </div>
        <div class="logo">
          <a href="../">mkDoku's World</a>
        </div>
        <div class="hakyll">
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          inside
        </div>
        <hr class="topRuler"> </hr>
      </div>

      <div id="mySidenav" class="sidenav">
        <a href="../" id="home">Home</a>
        <a href="../about.html" id="aboutMe">About Me</a>
        <a href="../blog.html" id="blog">Blog</a>
        <a href="../contact.html" id="contact">Contact</a>
      </div>
    </header>


    <main class="content">
      <h1>Reanimate 01 - Installation, Lines and Animation</h1>
      <article>

  <section class="content">
      <p>Visualization of complex concepts and systems aids in understanding. Static images or graphs are the method of choice and can be found everywhere - from textbooks over presentations to online websites.<br />
While animations can often be more easy and quick to understand, their creation can seem intimidating and labor-intensive.<br />
With this blog post I want to show you an easy way to create appealing animations. For this we will be using the <a href="https://www.haskell.org">Haskell</a> library <a href="https://reanimate.github.io/"><code>reanimate</code></a>.</p>
<h2 id="all-posts-of-this-series">All posts of this series</h2>
<ul>
<li><a href="../posts/2020-12-23-reanimate-01.html">01 - Installation, Lines and Animation</a></li>
<li><a href="../posts/2021-01-31-reanimate-02.html">02 - Coordinate systems and Scene</a></li>
</ul>
<h2 id="set-up">Set-up</h2>
<h3 id="reproducibility">Reproducibility</h3>
<p>For this blog post we use:</p>
<ul>
<li><a href="https://docs.haskellstack.org/en/stable/README/">stack</a> for building our program (lts-16.6)</li>
<li><a href="https://hackage.haskell.org/package/reanimate-1.0.0.0">reanimate-1.0.0.0</a></li>
</ul>
<h3 id="setting-up-the-project">Setting up the project</h3>
<p>First, we generate our project <code>reanimateMe</code> via <code>stack</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="ex">stack</span> new reanimateMe simple</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="bu">cd</span> reanimateMe</span></code></pre></div>
<p>Then, we download <code>reanimate-1.0.0.0</code>, so the version 1.0.0.0 of the <a href="https://reanimate.github.io/"><code>reanimate</code></a>, from <a href="https://hackage.haskell.org/package/reanimate-1.0.0.0">hackage</a> and untar it in the project directory:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="fu">tar</span> -xvf reanimate-1.0.0.0.tar.gz</span></code></pre></div>
<h3 id="the-cabal-and-stack-file">The cabal and stack file</h3>
<p>After that, we modify the <code>reanimateMe.cabal</code> and <code>stack.yaml</code> file to contain the following content:</p>
<p><code>reanimateMe.cabal</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="fu">name</span><span class="kw">:</span><span class="at">                reanimateMe</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="fu">version</span><span class="kw">:</span><span class="at">             </span><span class="fl">0.1.0.0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="fu">license</span><span class="kw">:</span><span class="at">             BSD3</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="fu">build-type</span><span class="kw">:</span><span class="at">          Simple</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="fu">cabal-version</span><span class="kw">:</span><span class="at">       &gt;=1.10</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="at">executable reanimateMe</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="at">  </span><span class="fu">hs-source-dirs</span><span class="kw">:</span><span class="at">      src</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a><span class="at">  </span><span class="fu">main-is</span><span class="kw">:</span><span class="at">             Main.hs</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="at">  </span><span class="fu">default-language</span><span class="kw">:</span><span class="at">    Haskell2010</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="at">  </span><span class="fu">build-depends</span><span class="kw">:</span><span class="at">       base &gt;= 4.7 &amp;&amp; &lt; 5</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="at">                     , reanimate-1.0.0.0</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="at">                     , reanimate-svg</span></span></code></pre></div>
<p><code>stack.yaml</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="fu">resolver</span><span class="kw">:</span><span class="at"> lts-16.6</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="fu">packages</span><span class="kw">:</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="kw">-</span><span class="at"> .</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">-</span><span class="at"> reanimate-1.0.0.0</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="fu">extra-deps</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="kw">-</span><span class="at"> hgeometry-0.11.0.0@sha256:09ead201a6ac3492c0be8dda5a6b32792b9ae87cab730b8362d46ee8d5c2acb4</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="kw">-</span><span class="at"> hgeometry-combinatorial-0.11.0.0@sha256:03176f235a1c49a415fe1266274dafca84deb917cbcbf9a654452686b4cd2bfe</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="kw">-</span><span class="at"> reanimate-svg-0.11.0.0@sha256:17b1a884a4428854608dd64c0d1e15d1aca05c8bd84781e360a6793b58461dd0</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="kw">-</span><span class="at"> vinyl-0.13.0@sha256:0f247cd3f8682b30881a07de18e6fec52d540646fbcb328420049cc8d63cd407</span></span></code></pre></div>
<h3 id="the-srcmain.hs-file">The <code>src/Main.hs</code> file</h3>
<p>To obtain our first “Hello World!”-like animation, we type the following content into <code>src/Main.hs</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="pp">#!/usr/bin/env stack</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co">-- stack runghc --package reanimate</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="kw">module</span> <span class="dt">Main</span> ( main ) <span class="kw">where</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Reanimate</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Reanimate.Builtin.Documentation</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Reanimate.Transition</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>main <span class="ot">=</span> reanimate <span class="op">$</span> docEnv <span class="op">$</span> playThenReverseA drawCircle</span></code></pre></div>
<p>With this code we are able to use the <code>reanimate</code> interpreter or render an animation to a desired output format, e.g. <code>.gif</code>.</p>
<h3 id="interpreting-the-hello-world-animation">Interpreting the “Hello, World!” animation</h3>
<p>The set-up is done and we are ready to use the <code>reanimate</code> interpreter. For this, we will build and install our program:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="ex">stack</span> install</span></code></pre></div>
<p>After that, we can run our <code>reanimate</code> interpreter in two different ways:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="ex">stack</span> src/Main.hs</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="ex">reanimateMe</span> --self src/Main.hs</span></code></pre></div>
<p>This will start the interpreter and the console output should look like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="ex">stack</span> src/Main.hs</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:38.08: Listening...</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.09: Opening browser...</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.22: Browser opened.</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.45: New connection received.</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.46: Reloading code...</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.46: GHCi reload done.</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.67: Framecount sent.</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:40.86: GHCi render done.</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:42.10: Compile done.</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a><span class="op">&gt;</span> <span class="ex">2020-12-20</span> 09:49:42.13: Optimized render done.</span></code></pre></div>
<p>Additionally, the interpreter will open our default web browser to display an animation. The following image is a screenshot taken after the browser is opened:</p>
<p><img src="../images/reanimateMe/interpreter.png" class="center" alt="Screenshot of a web browser after starting the interpreter" title="Screenshot of web browser"></p>
<p>Running the code using the interpreter is useful, because we can change the <code>src/Main.hs</code> file and the interpreter will show us the result (via the web browser), after we saved these changes. This will allow for quick prototyping of animations.<br />
However, the interpreter will not generate any output file. If we want to save the animation in an output file, we have to render the animation.</p>
<h3 id="rendering-the-hello-world-animation">Rendering the “Hello, World!” animation</h3>
<p>Let’s render our “Hello, World!” animation as a <code>.gif</code>. This is done by using the <code>render</code> argument:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="ex">stack</span> src/Main.hs -- render --format gif</span></code></pre></div>
<p>This will output <code>src/Main.gif</code> and will look like this, when opened in your web browser or image viewer of your choice:</p>
<p><img src="../images/reanimateMe/output.gif" class="center" alt="First Animation" title="First Animation"></p>
<p>If you want to speed up the compile time significantly use the <code>--compile</code> flag:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="ex">stack</span> src/Main.hs -- render --format gif --compile</span></code></pre></div>
<p>As you can see, <code>render</code> allows for saving our animation into an output file.</p>
<h2 id="a-star-is-born">A star is born</h2>
<p>Equipped with this knowledge of how to interpret and render our code, we can start to create our own custom animation(s).<br />
Let’s animate a star in two different ways:</p>
<p><img class="twoPics" src="../images/reanimateMe/chainTandThen.gif" alt="static line" title="A static line"> <img class="twoPics" src="../images/reanimateMe/chainTparASlow.gif" alt="static line" title="A static line"></p>
<p><strong>Disclaimer</strong>: The first few lines of our <code>Main.hs</code> will always look like this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="pp">#!/usr/bin/env stack</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="co">-- stack runghc --package reanimate</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="kw">module</span> <span class="dt">Main</span>( main ) <span class="kw">where</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Reanimate</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Reanimate.Builtin.Documentation</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Reanimate.Transition</span></span></code></pre></div>
<p>The first two lines are needed for communicating with the interpreter of <code>reanimate</code>, so that we can see our changes in the source code live in our web browser. Additionally, we have the last three lines to import the necessary libraries.</p>
<p>Because these lines of code will always look the same, we will not show them in the following part.</p>
<p><strong>Note</strong>: If you do not want to type or copy &amp; paste all the code snippets in the blog post, you can always use the <a href="https://github.com/mkDoku/reanimateMe">github repo of <code>reanimateMe</code></a>. Have a look at the different commits to follow along the steps of this blog post.</p>
<h3 id="in-the-beginning-there-was-a-line">In the beginning there was a line</h3>
<p>We will start simple, by animating a single line.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>main <span class="ot">=</span> reanimate</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>  <span class="op">$</span> docEnv</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>  <span class="op">$</span> staticFrame <span class="dv">1</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>  <span class="op">$</span> mkLine</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>    (screenLeft,  screenBottom)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>    (screenRight, screenTop   )</span></code></pre></div>
<p>Here, <code>mkLine</code> is a function which takes two coordinates, a start and end coordinate of the line and returns a <code>SVG</code>. <code>SVG</code> is a crucial type in the <code>reanimate</code> library, because it represents “the thing we want to animate”. However, this <code>SVG</code> alone cannot be rendered by <code>reanimate</code>, because the <code>reanimate</code> function takes an <code>Animation</code> as input argument.<br />
Hence, we need a function to transform a <code>SVG</code> to an <code>Animation</code>. To keep it simple, we will use the <code>staticFrame</code> function for this transformation.<br />
Compile and run the above code (either using the interpreter or the renderer) to see a line from the bottom left to the top right corner of the animation:</p>
<p><img src="../images/reanimateMe/staticLine.gif" class="center" alt="static line" title="A static line"></p>
<p>As the <code>staticFrame</code> function suggests, nothing moves in this animation.<br />
Now, let me give you some more details to the above code. <code>staticFrame</code> does not only take a <code>SVG</code> as an input but also a <code>Duration</code>. “But nothing is animated. Why do we have to pass a <code>Duration</code>?” This is because our final output will be a <code>.gif</code>, <code>.mp4</code> or the result seen in the browser (interpreter). Although the line does not seem to move, we have to tell <code>reanimate</code> how long our animation has to last. This becomes particularly important for sequences of animations. In the above case, the <code>Duration</code> of the animation is <code>1</code> and represents the duration of the animation in seconds.<br />
Then, there is the <code>docEnv</code> function, which enables the use of <code>Main.hs</code> with the <code>reanimate</code> interpreter in the browser.</p>
<h4 id="default-coordinates-in-reanimate">Default coordinates in <code>reanimate</code></h4>
<p>The remaining functions in the above code, <code>screenLeft</code>, <code>screenRight</code>, <code>screenBottom</code> and <code>screenTop</code>, are built-in functions of <code>reanimate</code>. They represent the horizontal and vertical distance from the center of the animation.<br />
By default the center is <code>(0,0)</code> and the aspect ratio is 16:9. This means that internal width of the animation is 16, while the height is 9.<br />
If we want to know the left most value in this default setting, we can use <code>screenLeft</code>, which would be <code>-8</code>. Combining this with <code>screenBottom</code>, which is <code>-4.5</code> (the bottom most value), results in the coordinate of the bottom left value <code>(-8, -4.5)</code>. These are the coordinates we used in the above code as start coordinate in the form of <code>(screenLeft,  screenBottom)</code>.</p>
<p><strong>Note</strong>: The default values for the aspect ratio can be changed using <a href="https://reanimate.readthedocs.io/en/latest/introduction/#custom-viewports">viewports</a> via the <a href="https://hackage.haskell.org/package/reanimate-1.0.0.0/docs/Reanimate-Svg-Constructors.html#v:withViewBox"><code>withViewBox</code></a> function, but this will be a topic for later blog posts.</p>
<h3 id="i-like-to-move-it">I like to move it!</h3>
<p>Now that we have created a static animation using <code>staticFrame</code>, it is time to animate it by modifying the above code to look like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>main <span class="ot">=</span> reanimate</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>  <span class="op">$</span> docEnv</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>  <span class="op">$</span> animate</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>  <span class="op">$</span> \t <span class="ot">-&gt;</span> partialSvg t</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>  <span class="op">$</span> pathify</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a>    customLine</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a><span class="ot">customLine ::</span> <span class="dt">SVG</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a>customLine <span class="ot">=</span> mkLine (screenLeft, screenBottom) (<span class="dv">0</span>, screenTop)</span></code></pre></div>
<p>Let me walk you through the code changes from the bottom to the top. First, we create a new <code>SVG</code> called <code>customLine</code>. This creates a different line than the one above. If we were to render this line with <code>staticFrame</code>, it would look like this:</p>
<p><img src="../images/reanimateMe/newStaticLine.gif" class="center" alt="A static line as first part of the star" title="A static line with new end coordinate"></p>
<p>This line represents the first of five lines for animating the final star.<br />
The next steps in the code are:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>  <span class="op">$</span> animate</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>  <span class="op">$</span> \t <span class="ot">-&gt;</span> partialSvg t</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>  <span class="op">$</span> pathify</span></code></pre></div>
<p>The idea behind these three lines of code is to transform our <code>customLine</code>, so a <code>SVG</code>, to an <code>Animation</code> using <code>animate</code>. This function has the following type signature:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="ot">animate ::</span> (<span class="dt">Time</span> <span class="ot">-&gt;</span> <span class="dt">SVG</span>) <span class="ot">-&gt;</span> <span class="dt">Animation</span></span></code></pre></div>
<p>Hence, we have to pass a function of type <code>(Time -&gt; SVG)</code> to <code>animate</code> to obtain an <code>Animation</code>. This function will represent the way our <code>SVG</code> is animated. Because we want to draw a <code>customLine</code> in small increments over time, we first have to slice it up into small fragments. This is done using <code>pathify</code>. In the second step, we pass the sliced-up <code>SVG</code> to <code>\t -&gt; partialSvg t</code>. This lambda function takes the current frame number and displays the <code>SVG</code> up to this point in the animation.<br />
In our specific example, <code>customLine</code> is sliced-up into 60 fragments (<code>pathify</code>), which are continuously displayed (<code>\t -&gt; partialSvg t</code>) in 60 frames (1 second).<br />
The resulting animation will look like this:</p>
<p><img src="../images/reanimateMe/animatedLine.gif" class="center" alt="Line (animated)" title="A animated line"></p>
<p>We have our first animation with a duration of one second. <strong>Yeah!</strong></p>
<h3 id="more-lines-animations">More lines (<code>Animation</code>s)</h3>
<p>For our star we need four additional lines. Before creating these, we will define some helper functions to make our life easier.<br />
First, we create some custom functions representing the coordinates of the five vertices of the star:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>customHeigth <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>leftBottom   <span class="ot">=</span> (screenLeft  , screenBottom)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>middleTop    <span class="ot">=</span> (<span class="dv">0</span>           , screenTop   )</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>rightBottom  <span class="ot">=</span> (screenRight , screenBottom)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>leftCustom   <span class="ot">=</span> (screenLeft  , customHeigth)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>rightCustom  <span class="ot">=</span> (screenRight , customHeigth)</span></code></pre></div>
<p>Next, we implement a function, which creates an animated line like above, but for arbitrary start and end coordinates.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>customDuration <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="ot">animatePart ::</span> (<span class="dt">Double</span>, <span class="dt">Double</span>) <span class="ot">-&gt;</span> (<span class="dt">Double</span>, <span class="dt">Double</span>) <span class="ot">-&gt;</span> <span class="dt">Animation</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a>animatePart coord1 coord2 <span class="ot">=</span> setDuration customDuration <span class="op">$</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>    animate</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>  <span class="op">$</span> \t <span class="ot">-&gt;</span> partialSvg t</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>  <span class="op">$</span> pathify</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>  <span class="op">$</span> mkLine coord1 coord2</span></code></pre></div>
<p><code>animatePart</code> reuses the <code>animate</code>,<code>partialSvg</code>,<code>pathify</code> and <code>mkLine</code> pattern from before and extends it by <code>setDuration</code>. With <code>setDuration</code> we can vary the length of the created animation. For this tutorial, we will choose <code>1</code> as duration, which is the default value of <code>animate</code>.</p>
<h3 id="connecting-animations">Connecting <code>Animation</code>s</h3>
<p>With <code>animatePart</code> and the five coordinates at hand, we can create five <code>Animation</code>s - one animation for each segment of the star:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>ani1 <span class="ot">=</span> animatePart leftBottom  middleTop</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>ani2 <span class="ot">=</span> animatePart middleTop   rightBottom</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>ani3 <span class="ot">=</span> animatePart rightBottom leftCustom</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>ani4 <span class="ot">=</span> animatePart leftCustom  rightCustom</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>ani5 <span class="ot">=</span> animatePart rightCustom leftBottom</span></code></pre></div>
<p>Each of these segments represent an animated line. The only thing left to do to obtain the final star is to connect these animations.<br />
For this, <code>reanimate</code> provides so-called <code>Transition</code>s. Here are the type signatures of two of these <code>Transition</code>s:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="ot">andThen ::</span> <span class="dt">Animation</span> <span class="ot">-&gt;</span> <span class="dt">Animation</span> <span class="ot">-&gt;</span> <span class="dt">Animation</span> <span class="co">-- or Transition</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="ot">parA    ::</span> <span class="dt">Animation</span> <span class="ot">-&gt;</span> <span class="dt">Animation</span> <span class="ot">-&gt;</span> <span class="dt">Animation</span> <span class="co">-- or Transition</span></span></code></pre></div>
<p>With <code>andThen</code> we can connect <code>Animation</code>s sequentially, while <code>parA</code> allows us to animate <code>Animation</code>s in parallel.</p>
<h4 id="connecting-two-animations">Connecting two <code>Animation</code>s</h4>
<p>Before connecting all five <code>Animation</code>s we will first connect two <code>Animation</code>s. This can be done using <code>andThen</code> like this:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>main <span class="ot">=</span> reanimate</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>  <span class="op">$</span> docEnv (ani1 <span class="ot">`andThen`</span> ani2)</span></code></pre></div>
<p>With this, we obtain the following animation:</p>
<p><img src="../images/reanimateMe/twoLines.gif" class="center" alt="Two lines (andThen)" title="Two animated lines (andThen)"></p>
<p>By using <code>parA</code> instead of <code>andThen</code>, we obtain this:</p>
<p><img src="../images/reanimateMe/twoLinesPara.gif" class="center" alt="Two lines (parA)" title="Two animated lines (parA)"></p>
<h4 id="connecting-more-than-two-animations">Connecting more than two <code>Animation</code>s</h4>
<p>Composing more than two <code>Animation</code>s like in the above examples would become cumbersome and less expressive - we need some alternatives. The first alternative is <code>chainT</code>, which has the following type signature:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="ot">chainT ::</span> <span class="dt">Transition</span> <span class="ot">-&gt;</span> [<span class="dt">Animation</span>] <span class="ot">-&gt;</span> <span class="dt">Animation</span></span></code></pre></div>
<p>Given a <code>Transition</code>, <code>chainT</code> will apply this <code>Transition</code> to a list of <code>Animation</code>s and return one final <code>Animation</code>.<br />
Enough talking! Let’s use <code>chainT</code> in combination with <code>andThen</code>, which is a <code>Transition</code>, to animate our first star:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>main <span class="ot">=</span> reanimate</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a> <span class="op">$</span> docEnv</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a> <span class="op">$</span> chainT andThen [ani1, ani2, ani3, ani4, ani5]</span></code></pre></div>
<p>The result will look like this:</p>
<p><img src="../images/reanimateMe/chainTandThen.gif" class="center" alt="Chaining (andThen)" title="Chaining animations (andThen)"></p>
<p>Using <code>parA</code> instead of <code>andThen</code>, would result in this:</p>
<p><img src="../images/reanimateMe/chainTparA.gif" class="center" alt="Chaining (parA)" title="Chaining animations (parA)"></p>
<p>As you can see, connecting <code>parA</code> with <code>chainT</code> results in a much faster animation, which is due to a fault in the implementation of <code>animatePart</code>: <code>customDuration</code> is always <code>1</code>, regardless of the number of <code>Transition</code>s used later on. While drawing each line will take one second, drawing them in parallel will also take just one second. To fix this for the <code>parA</code> part, we could choose <code>customDuration</code> to be <code>5</code>. Resulting in an animation which takes as long as the <code>andThen</code> case.</p>
<p><img src="../images/reanimateMe/chainTparASlow.gif" class="center" alt="Chaining (parA, slow)" title="Chaining animations (parA, slow)"></p>
<h2 id="a-special-alternative">A special alternative</h2>
<p>In the case of <code>chainT</code> combined with <code>andThen</code>, we are using only primitive lines for constructing our star animation. <code>reanimate</code> provides <code>mkLinePath</code> to construct a <code>SVG</code> from a list of coordinates like this:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a>main <span class="ot">=</span> reanimate</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a>  <span class="op">$</span> docEnv</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a>  <span class="op">$</span> setDuration <span class="dv">5</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a>  <span class="op">$</span> animate</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>  <span class="op">$</span> \t <span class="ot">-&gt;</span> partialSvg t</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a>  <span class="op">$</span> pathify customPath</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a><span class="ot">customPath ::</span> <span class="dt">SVG</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a>customPath <span class="ot">=</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a>  mkLinePath</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a>    [ leftBottom,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a>      middleTop,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a>      rightBottom,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true"></a>      leftCustom,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true"></a>      rightCustom,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true"></a>      leftBottom</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true"></a>    ]</span></code></pre></div>
<p>This code will result in the same animation as in the <code>chainT andThen</code> example above. The big difference, however, is that we construct our star-<code>SVG</code> using <code>customPath</code> and then apply <code>pathify</code> to the whole star instead of creating five different animations and connecting them using <code>chainT andThen</code>.</p>
<p>With this, we have reached our final goal - animating a star in two different ways.</p>
<p><img class="twoPics" src="../images/reanimateMe/chainTandThen.gif" alt="static line" title="A static line"> <img class="twoPics" src="../images/reanimateMe/chainTparASlow.gif" alt="static line" title="A static line"></p>
<h2 id="conclusion">Conclusion</h2>
<p><code>reanimate</code> provides expressive functions for the generation of animations. We learned how to animate lines and connect them in different ways. The final result are two different animations of the same star.</p>
<p>So far, we have only scratched the surface of <code>reanimate</code>. In future blog post we will learn a lot more about <code>reaniamte</code>.</p>
<p>Stay tuned and see you next time!</p>
<h2 id="appendix">Appendix</h2>
<h3 id="github-repository">Github repository</h3>
<p>All code snippets can be found in this <a href="https://github.com/mkDoku/reanimateMe">github repository</a>. You can browse the commit history of <code>src/Main.hs</code> to run the code for every section of this blog post.</p>
<h3 id="installation-manjaro-linux">Installation (Manjaro Linux)</h3>
<p>During the installation of <code>chipmunk2D</code> (a dependency of <code>reanimate</code>) the <code>gcc</code> compiler could not find <code>sys/sysctl.sh</code>. The reason for this was that the compiler was looking at <code>/usr/include/sys</code> for the library. In Manjaro Linux, however, this library is located at <code>/usr/include/linux</code>.<br />
For solving this problem I generated a symbolic link like this:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="fu">mkdir</span> -p /usr/include/sys</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a><span class="fu">ln</span> -s /usr/include/linux/sysctl.h /usr/include/sys/</span></code></pre></div>
<p>Don’t forget to use <code>sudo</code> if you don’t have permission to create the symbolic link!</p>
  </section>

  <footer class="info">
    Posted on December 23, 2020

    
      by Sascha Bubeck
    

    
    <br> Topics: <a href="../tags/Reanimate.html" class="tag">Reanimate</a><a href="../tags/Haskell.html" class="tag">Haskell</a><a href="../tags/Animation.html" class="tag">Animation</a>
    
  </footer>

</article>

    </main>


  </body>
</html>
